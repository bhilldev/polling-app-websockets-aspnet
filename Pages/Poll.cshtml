@page
@model PollModel
@{
    ViewData["Title"] = "Poll Client";
}

<h2>Poll WebSocket Client</h2>

<div id="messages"></div>
<input id="messageInput" placeholder="Type a message..." />
<button id="sendBtn">Send</button>

@section Scripts {
    <script>
        const socket = new WebSocket("wss://" + window.location.host + "/poll");

        socket.onopen = () => {
            console.log("Connected to WebSocket.");
            document.getElementById("messages").innerHTML += "<div>Connected!</div>";
        };

        socket.onmessage = (event) => {
            document.getElementById("messages").innerHTML += "<div>Received: " + event.data + "</div>";
        };

        socket.onclose = () => {
            document.getElementById("messages").innerHTML += "<div>Disconnected.</div>";
        };

        document.getElementById("sendBtn").addEventListener("click", () => {
            const msg = document.getElementById("messageInput").value;
            socket.send(msg);
        });
    </script>
}
